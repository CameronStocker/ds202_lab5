---
title: "Lab 5"
author: "Cameron Stocker and Tyler Kruzan"
date: "11/12/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r,include=FALSE}
library(tidyr)
library(dplyr)
library(ggplot2)
```

###1
```{r}
diabetes = read.table("diabetes.txt", header = TRUE)
str(diabetes)
```
####2
```{r}
diabetes[which(diabetes$frame == ''), 'frame'] = NA
diabetes$frame = droplevels(diabetes$frame)
```
###3
```{r}
diabetes_reduced = select(diabetes, -id, -bp.2s, -bp.2d)
```
###4
```{r}
diabetes_clean = diabetes_reduced[complete.cases(diabetes_reduced),]
```
####5
```{r}
summary(diabetes_clean)
```
You can see that Step 4 was completed correctly beause summary does not show any NA values. 

####6 & 7
```{r}
diabetes_clean = mutate(diabetes_clean, glyhb_star = log(glyhb))
ggplot(diabetes_clean, aes(glyhb_star)) + geom_histogram(bins = 10)
```

We have used a log transformation on the dataset. It is a relatively strong transformation which makes its interpretability much harder.However, the transformation works because the graph is less right skewed. If you account for less bins, the distribution appears to much more normal.

####8 
```{r}
diabetes_clean %>% group_by(frame) %>% summarise(mean.glyhb = mean(glyhb_star))

diabetes_clean %>% group_by(waist) %>% summarise(mean.glyhb = mean(glyhb_star))

diabetes_clean %>% group_by(height) %>% summarise(mean.glyhb = mean(glyhb_star))

diabetes_clean %>% group_by(location) %>% summarise(mean.glyhb = mean(glyhb_star))

diabetes_clean %>% group_by(gender) %>% summarise(mean.glyhb = mean(glyhb_star))
```

`frame`, `waist`, & `height` all have a correlation, as the variable gets larger, the average Glycosolated Hemoglobin has a positive relationship and increases as well. When we summarized `location` & `gender` we found not relationship with the Glycosolated Hemoglobin. 
###10
```{r}
diabetes_clean %>% group_by(frame, location) %>% summarise(mean.glyhb_star=mean(glyhb_star)) %>%
  ggplot(aes(x = frame, y = mean.glyhb_star, color=location))+
  geom_point()
```
###11
```{r}
ggplot(diabetes_clean, aes(ratio, glyhb_star)) + geom_point()
ggplot(diabetes_clean, aes(bp.1s, glyhb_star)) + geom_point()
ggplot(diabetes_clean, aes(age, glyhb_star)) + geom_point()
ggplot(diabetes_clean, aes(hip, glyhb_star)) + geom_point()
ggplot(diabetes_clean, aes(weight, glyhb_star)) + geom_point()
ggplot(diabetes_clean, aes(x = gender, y = glyhb_star)) + geom_boxplot()
```
####12
```{r}
ggplot(diabetes_clean,aes(y=weight,x=waist,alpha=0.5)) + geom_point(aes(color = diabetes_clean$weight)) +  facet_wrap(~frame) +labs(title = "Weight & Waist Length by Frame Size", x = "Waist Length (inches)", y = "Weight (lbs)")
```
